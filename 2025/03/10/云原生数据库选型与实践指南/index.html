<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/Bopop-logo.png">
  <link rel="icon" type="image/png" href="/img/Bopop-logo.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="This v blog">
  <meta name="author" content="BoDen">
  <meta name="keywords" content="Bopop,blog,åšå®¢,PHP,Python,Golang">
  <title>ğŸ—„ï¸ äº‘åŸç”Ÿæ•°æ®åº“é€‰å‹ä¸å®è·µæŒ‡å— - Bopop</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
  

  


<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_yg9cfy8wd6.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script  src="/js/utils.js" ></script>
<meta name="generator" content="Hexo 5.0.2"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Bopop</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/pexels.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
                ğŸ—„ï¸ äº‘åŸç”Ÿæ•°æ®åº“é€‰å‹ä¸å®è·µæŒ‡å—
              
            </span>

            
              
  <div class="mt-3 post-meta">
    <i class="iconfont icon-date-fill" aria-hidden="true"></i>
    <time datetime="2025-03-10 16:45">
      2025å¹´3æœˆ10æ—¥ ä¸‹åˆ
    </time>
  </div>


<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      4.1k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      53
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <h1>ğŸ—„ï¸ äº‘åŸç”Ÿæ•°æ®åº“é€‰å‹ä¸å®è·µæŒ‡å—</h1>
<p>éšç€äº‘åŸç”Ÿæ¶æ„çš„æ™®åŠï¼Œä¼ ç»Ÿæ•°æ®åº“é¢ä¸´è¯¸å¤šæŒ‘æˆ˜ã€‚æœ¬æ–‡å°†åˆ†äº«æˆ‘åœ¨é€‰å‹å’Œä½¿ç”¨äº‘åŸç”Ÿæ•°æ®åº“æ—¶çš„å®è·µç»éªŒï¼ŒåŒ…æ‹¬è¯„ä¼°æ ‡å‡†ã€å¸¸è§é€‰å‹ã€éƒ¨ç½²ç­–ç•¥å’Œæ€§èƒ½ä¼˜åŒ–æŠ€å·§ã€‚</p>
<h2 id="ğŸŒ¥ï¸-ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿæ•°æ®åº“ï¼Ÿ"><a class="header-anchor" href="#ğŸŒ¥ï¸-ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿæ•°æ®åº“ï¼Ÿ"></a>ğŸŒ¥ï¸ ä»€ä¹ˆæ˜¯äº‘åŸç”Ÿæ•°æ®åº“ï¼Ÿ</h2>
<p>ç®€å•æ¥è¯´ï¼Œäº‘åŸç”Ÿæ•°æ®åº“æ˜¯ä¸“ä¸ºäº‘ç¯å¢ƒè®¾è®¡çš„æ•°æ®åº“ç³»ç»Ÿï¼Œå…·æœ‰ä»¥ä¸‹å…³é”®ç‰¹å¾ï¼š</p>
<ul>
<li><strong>å¼¹æ€§ä¼¸ç¼©</strong>ï¼šèƒ½å¤ŸåŠ¨æ€æ‰©å®¹/ç¼©å®¹ï¼Œé€‚åº”è´Ÿè½½å˜åŒ–</li>
<li><strong>é«˜å¯ç”¨æ€§</strong>ï¼šå…·å¤‡è·¨åŒºåŸŸ/å¯ç”¨åŒºå®¹ç¾èƒ½åŠ›</li>
<li><strong>è‡ªåŠ¨åŒ–è¿ç»´</strong>ï¼šæ”¯æŒè‡ªåŠ¨åŒ–éƒ¨ç½²ã€å¤‡ä»½ã€æ¢å¤ç­‰æ“ä½œ</li>
<li><strong>Kuberneteså‹å¥½</strong>ï¼šè‰¯å¥½æ”¯æŒå®¹å™¨åŒ–å’Œåè°ƒç¼–æ’</li>
<li><strong>æŒ‰éœ€è®¡è´¹</strong>ï¼šæ”¯æŒèµ„æºçš„é«˜æ•ˆåˆ©ç”¨å’Œç²¾ç¡®è®¡è´¹</li>
</ul>
<p>ä¼ ç»Ÿæ•°æ®åº“ä¸äº‘åŸç”Ÿæ•°æ®åº“çš„åŒºåˆ«ï¼š</p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>ä¼ ç»Ÿæ•°æ®åº“</th>
<th>äº‘åŸç”Ÿæ•°æ®åº“</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ¶æ„</td>
<td>å•ä½“/ä¸»ä»æ¶æ„</td>
<td>åˆ†å¸ƒå¼/å…±äº«å­˜å‚¨</td>
</tr>
<tr>
<td>æ‰©å±•æ–¹å¼</td>
<td>å‚ç›´æ‰©å±•(æ›´å¤§æœºå™¨)</td>
<td>æ°´å¹³æ‰©å±•(æ›´å¤šèŠ‚ç‚¹)</td>
</tr>
<tr>
<td>å®¹ç¾èƒ½åŠ›</td>
<td>æ‰‹åŠ¨é…ç½®ï¼Œå¤æ‚</td>
<td>å†…ç½®å¤šåŒºåŸŸå¤åˆ¶èƒ½åŠ›</td>
</tr>
<tr>
<td>ç®¡ç†æ–¹å¼</td>
<td>äººå·¥è¿ç»´ä¸ºä¸»</td>
<td>è‡ªåŠ¨åŒ–ã€å£°æ˜å¼ç®¡ç†</td>
</tr>
<tr>
<td>èµ„æºåˆ©ç”¨</td>
<td>é¢„åˆ†é…ï¼Œåˆ©ç”¨ç‡ä½</td>
<td>æŒ‰éœ€åˆ†é…ï¼Œèµ„æºæ± åŒ–</td>
</tr>
<tr>
<td>æˆæœ¬æ¨¡å‹</td>
<td>å›ºå®šæˆæœ¬ä¸ºä¸»</td>
<td>å¼¹æ€§è®¡è´¹ä¸ºä¸»</td>
</tr>
</tbody>
</table>
<h2 id="ğŸ”-äº‘åŸç”Ÿæ•°æ®åº“è¯„ä¼°æ ‡å‡†"><a class="header-anchor" href="#ğŸ”-äº‘åŸç”Ÿæ•°æ®åº“è¯„ä¼°æ ‡å‡†"></a>ğŸ” äº‘åŸç”Ÿæ•°æ®åº“è¯„ä¼°æ ‡å‡†</h2>
<p>åœ¨é€‰æ‹©äº‘åŸç”Ÿæ•°æ®åº“æ—¶ï¼Œåº”è¯¥è€ƒè™‘ä»¥ä¸‹å…³é”®å› ç´ ï¼š</p>
<h3 id="1-æ•°æ®æ¨¡å‹ä¸ç”¨ä¾‹é€‚é…"><a class="header-anchor" href="#1-æ•°æ®æ¨¡å‹ä¸ç”¨ä¾‹é€‚é…"></a>1. æ•°æ®æ¨¡å‹ä¸ç”¨ä¾‹é€‚é…</h3>
<p>ä¸åŒæ•°æ®åº“æ”¯æŒä¸åŒçš„æ•°æ®æ¨¡å‹ï¼š</p>
<ul>
<li><strong>å…³ç³»å‹</strong>ï¼šé€‚åˆäº‹åŠ¡å¤„ç†å’Œå¤æ‚æŸ¥è¯¢ï¼ˆPostgreSQLã€MySQLã€CockroachDBï¼‰</li>
<li><strong>æ–‡æ¡£å‹</strong>ï¼šé€‚åˆåŠç»“æ„åŒ–æ•°æ®ï¼ˆMongoDBã€Couchbaseï¼‰</li>
<li><strong>é”®å€¼å‹</strong>ï¼šé€‚åˆé«˜ååä½å»¶è¿Ÿåœºæ™¯ï¼ˆRedisã€DynamoDBï¼‰</li>
<li><strong>åˆ—æ—å‹</strong>ï¼šé€‚åˆæ—¶åºå’Œåˆ†æåœºæ™¯ï¼ˆCassandraã€ScyllaDBï¼‰</li>
<li><strong>å›¾æ•°æ®åº“</strong>ï¼šé€‚åˆå…³ç³»å¤æ‚çš„æ•°æ®ï¼ˆNeo4jã€JanusGraphï¼‰</li>
</ul>
<h3 id="2-ä¸€è‡´æ€§ä¸CAPé€‰æ‹©"><a class="header-anchor" href="#2-ä¸€è‡´æ€§ä¸CAPé€‰æ‹©"></a>2. ä¸€è‡´æ€§ä¸CAPé€‰æ‹©</h3>
<p>CAPå®šç†è¡¨æ˜åˆ†å¸ƒå¼ç³»ç»Ÿæ— æ³•åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸‰ç‚¹ï¼š</p>
<ul>
<li><strong>ä¸€è‡´æ€§Â©</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹çœ‹åˆ°ç›¸åŒçš„æ•°æ®</li>
<li><strong>å¯ç”¨æ€§(A)</strong>ï¼šæ¯ä¸ªè¯·æ±‚éƒ½èƒ½æ”¶åˆ°å“åº”</li>
<li><strong>åˆ†åŒºå®¹å¿Â§</strong>ï¼šå³ä½¿ç½‘ç»œåˆ†åŒºï¼Œç³»ç»Ÿä»èƒ½è¿è¡Œ</li>
</ul>
<p>äº‘åŸç”Ÿæ•°æ®åº“çš„CAPå®šä½ï¼š</p>
<table>
<thead>
<tr>
<th>æ•°æ®åº“</th>
<th>CAPé€‰æ‹©</th>
<th>é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>PostgreSQL (å•ä½“)</td>
<td>CA</td>
<td>å¼ºäº‹åŠ¡åœºæ™¯</td>
</tr>
<tr>
<td>CockroachDB</td>
<td>CP</td>
<td>åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¤šåŒºåŸŸéƒ¨ç½²</td>
</tr>
<tr>
<td>MongoDB</td>
<td>CPæˆ–AP(å¯é…ç½®)</td>
<td>æ–‡æ¡£å­˜å‚¨ï¼Œå¼¹æ€§æ‰©å±•</td>
</tr>
<tr>
<td>Cassandra</td>
<td>AP</td>
<td>é«˜å¯ç”¨æ€§å†™å…¥åœºæ™¯</td>
</tr>
<tr>
<td>Redis Cluster</td>
<td>CP</td>
<td>é«˜æ€§èƒ½ç¼“å­˜å’Œç®€å•å­˜å‚¨</td>
</tr>
</tbody>
</table>
<h3 id="3-è¿ç»´å¤æ‚åº¦"><a class="header-anchor" href="#3-è¿ç»´å¤æ‚åº¦"></a>3. è¿ç»´å¤æ‚åº¦</h3>
<p>è¯„ä¼°è¿ç»´è´Ÿæ‹…æ—¶éœ€è¦è€ƒè™‘ï¼š</p>
<ul>
<li><strong>è‡ªæ‰˜ç®¡æˆæœ¬</strong>ï¼šç»´æŠ¤äº‘åŸç”Ÿæ•°æ®åº“é›†ç¾¤çš„äººåŠ›æˆæœ¬</li>
<li><strong>è‡ªåŠ¨åŒ–ç¨‹åº¦</strong>ï¼šè‡ªåŠ¨ä¼¸ç¼©ã€è‡ªåŠ¨å¤‡ä»½ç­‰èƒ½åŠ›</li>
<li><strong>ç›‘æ§ä¸å¯è§‚æµ‹æ€§</strong>ï¼šå†…ç½®çš„ç›‘æ§å’Œè¯Šæ–­èƒ½åŠ›</li>
<li><strong>å‡çº§ç­–ç•¥</strong>ï¼šé›¶åœæœºå‡çº§çš„æ”¯æŒç¨‹åº¦</li>
<li><strong>ç”Ÿæ€å·¥å…·é“¾</strong>ï¼šå¤‡ä»½ã€è¿ç§»ã€æ•°æ®é›†æˆç­‰å·¥å…·å®Œå–„åº¦</li>
</ul>
<h3 id="4-æ€§èƒ½ä¸å¯ä¼¸ç¼©æ€§"><a class="header-anchor" href="#4-æ€§èƒ½ä¸å¯ä¼¸ç¼©æ€§"></a>4. æ€§èƒ½ä¸å¯ä¼¸ç¼©æ€§</h3>
<p>æ ¹æ®åº”ç”¨éœ€æ±‚è¯„ä¼°æ€§èƒ½ç‰¹å¾ï¼š</p>
<ul>
<li><strong>ååé‡</strong>ï¼šæ¯ç§’æŸ¥è¯¢/äº‹åŠ¡æ•°</li>
<li><strong>å»¶è¿Ÿ</strong>ï¼šå“åº”æ—¶é—´æŒ‡æ ‡(å¹³å‡ã€P95ã€P99)</li>
<li><strong>æ°´å¹³æ‰©å±•èƒ½åŠ›</strong>ï¼šå¢åŠ èŠ‚ç‚¹å¸¦æ¥çš„çº¿æ€§å¢é•¿ç¨‹åº¦</li>
<li><strong>å‚ç›´æ‰©å±•é™åˆ¶</strong>ï¼šå•èŠ‚ç‚¹å¯æ”¯æŒçš„æœ€å¤§è§„æ¨¡</li>
<li><strong>çƒ­ç‚¹å¤„ç†</strong>ï¼šå¤„ç†æ•°æ®è®¿é—®ä¸å‡è¡¡çš„èƒ½åŠ›</li>
</ul>
<h3 id="5-æˆæœ¬ç»“æ„"><a class="header-anchor" href="#5-æˆæœ¬ç»“æ„"></a>5. æˆæœ¬ç»“æ„</h3>
<p>ä¸åŒæ•°æ®åº“çš„æˆæœ¬å› ç´ ï¼š</p>
<ul>
<li><strong>è®¸å¯æ¨¡å¼</strong>ï¼šå¼€æºã€å•†ä¸šè®¸å¯æˆ–æ··åˆæ¨¡å¼</li>
<li><strong>è®¡ç®—èµ„æº</strong>ï¼šCPUã€å†…å­˜éœ€æ±‚</li>
<li><strong>å­˜å‚¨æˆæœ¬</strong>ï¼šæ¯GBå­˜å‚¨ä»·æ ¼ï¼Œå‹ç¼©ç‡</li>
<li><strong>ç½‘ç»œæˆæœ¬</strong>ï¼šè·¨åŒºåŸŸå¤åˆ¶ã€æ•°æ®ä¼ è¾“è´¹ç”¨</li>
<li><strong>è¿ç»´å¼€é”€</strong>ï¼šä¸“ä¸šçŸ¥è¯†è¦æ±‚å’ŒäººåŠ›æˆæœ¬</li>
</ul>
<h2 id="ğŸ“Š-ä¸»æµäº‘åŸç”Ÿæ•°æ®åº“å¯¹æ¯”"><a class="header-anchor" href="#ğŸ“Š-ä¸»æµäº‘åŸç”Ÿæ•°æ®åº“å¯¹æ¯”"></a>ğŸ“Š ä¸»æµäº‘åŸç”Ÿæ•°æ®åº“å¯¹æ¯”</h2>
<h3 id="å…³ç³»å‹æ•°æ®åº“"><a class="header-anchor" href="#å…³ç³»å‹æ•°æ®åº“"></a>å…³ç³»å‹æ•°æ®åº“</h3>
<h4 id="1-Amazon-Aurora"><a class="header-anchor" href="#1-Amazon-Aurora"></a>1. Amazon Aurora</h4>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>AWSåŸç”Ÿäº‘æ•°æ®åº“ï¼Œå…¼å®¹MySQLå’ŒPostgreSQL</li>
<li>å­˜å‚¨å’Œè®¡ç®—åˆ†ç¦»æ¶æ„</li>
<li>6è·¯è·¨å¯ç”¨åŒºå¤åˆ¶</li>
<li>10GBå¢é‡çš„è‡ªåŠ¨æ‰©å±•</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>AWSç”Ÿæ€ç³»ç»Ÿå†…çš„åº”ç”¨</li>
<li>éœ€è¦MySQL/PostgreSQLå…¼å®¹æ€§çš„åœºæ™¯</li>
<li>è¦æ±‚é«˜å¯ç”¨æ€§çš„ä¼ä¸šåº”ç”¨</li>
</ul>
<p><strong>éƒ¨ç½²ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs terraform">resource &quot;aws_rds_cluster&quot; &quot;aurora&quot; &#123;
  cluster_identifier      &#x3D; &quot;aurora-cluster&quot;
  engine                  &#x3D; &quot;aurora-postgresql&quot;
  engine_version          &#x3D; &quot;13.6&quot;
  database_name           &#x3D; &quot;mydb&quot;
  master_username         &#x3D; &quot;admin&quot;
  master_password         &#x3D; &quot;password&quot;
  backup_retention_period &#x3D; 7
  preferred_backup_window &#x3D; &quot;07:00-09:00&quot;
  availability_zones      &#x3D; [&quot;us-west-2a&quot;, &quot;us-west-2b&quot;, &quot;us-west-2c&quot;]
  db_subnet_group_name    &#x3D; aws_db_subnet_group.default.name
  skip_final_snapshot     &#x3D; true
  
  scaling_configuration &#123;
    auto_pause               &#x3D; true
    max_capacity             &#x3D; 16
    min_capacity             &#x3D; 2
    seconds_until_auto_pause &#x3D; 300
  &#125;
&#125;</code></pre>
<h4 id="2-CockroachDB"><a class="header-anchor" href="#2-CockroachDB"></a>2. CockroachDB</h4>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>åˆ†å¸ƒå¼SQLæ•°æ®åº“ï¼Œå…¼å®¹PostgreSQL</li>
<li>å¼ºä¸€è‡´æ€§(CP)ï¼Œæ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡</li>
<li>æ— å…±äº«æ¶æ„ï¼Œçº¿æ€§æ‰©å±•</li>
<li>å¤šåŒºåŸŸéƒ¨ç½²å’ŒGeo-partitioning</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>å…¨çƒåˆ†å¸ƒå¼åº”ç”¨</li>
<li>éœ€è¦å¼ºä¸€è‡´æ€§å’Œé«˜å¯ç”¨æ€§</li>
<li>Kubernetesç¯å¢ƒä¸­çš„äº‘åŸç”Ÿåº”ç”¨</li>
</ul>
<p><strong>Kuberneteséƒ¨ç½²ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">crdb.cockroachlabs.com/v1alpha1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">CrdbCluster</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">cockroachdb</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">dataStore:</span>
    <span class="hljs-attr">pvc:</span>
      <span class="hljs-attr">spec:</span>
        <span class="hljs-attr">accessModes:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-string">ReadWriteOnce</span>
        <span class="hljs-attr">resources:</span>
          <span class="hljs-attr">requests:</span>
            <span class="hljs-attr">storage:</span> <span class="hljs-string">100Gi</span>
        <span class="hljs-attr">volumeMode:</span> <span class="hljs-string">Filesystem</span>
  <span class="hljs-attr">nodes:</span> <span class="hljs-number">3</span>
  <span class="hljs-attr">tlsEnabled:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">image:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">cockroachdb/cockroach:v22.1.10</span>
  <span class="hljs-attr">resources:</span>
    <span class="hljs-attr">requests:</span>
      <span class="hljs-attr">cpu:</span> <span class="hljs-number">2</span>
      <span class="hljs-attr">memory:</span> <span class="hljs-string">8Gi</span>
    <span class="hljs-attr">limits:</span>
      <span class="hljs-attr">cpu:</span> <span class="hljs-number">4</span>
      <span class="hljs-attr">memory:</span> <span class="hljs-string">16Gi</span></code></pre>
<h4 id="3-YugabyteDB"><a class="header-anchor" href="#3-YugabyteDB"></a>3. YugabyteDB</h4>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>åˆ†å¸ƒå¼SQLå’ŒNoSQLæ¥å£(å…¼å®¹PostgreSQLå’ŒCassandra)</li>
<li>å¼ºä¸€è‡´æ€§ï¼Œå®Œæ•´ACIDäº‹åŠ¡</li>
<li>æ°´å¹³æ‰©å±•ï¼Œè‡ªåŠ¨åˆ†ç‰‡</li>
<li>å¤šåŒºåŸŸå’Œå¤šäº‘éƒ¨ç½²èƒ½åŠ›</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>æ··åˆSQL/NoSQLå·¥ä½œè´Ÿè½½</li>
<li>éœ€è¦ä½å»¶è¿Ÿå…¨çƒåˆ†å¸ƒçš„åº”ç”¨</li>
<li>ä»å•ä½“æ•°æ®åº“è¿ç§»åˆ°äº‘åŸç”Ÿæ¶æ„</li>
</ul>
<p><strong>Helméƒ¨ç½²ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs bash">helm repo add yugabytedb https://charts.yugabyte.com
helm install yugabyte yugabytedb/yugabyte \
  --<span class="hljs-built_in">set</span> replicas.tserver=3,\
  replicas.master=3,\
  resource.tserver.requests.cpu=2,\
  resource.tserver.requests.memory=4Gi,\
  resource.master.requests.cpu=1,\
  resource.master.requests.memory=2Gi</code></pre>
<h3 id="NoSQLæ•°æ®åº“"><a class="header-anchor" href="#NoSQLæ•°æ®åº“"></a>NoSQLæ•°æ®åº“</h3>
<h4 id="1-MongoDB-Atlas"><a class="header-anchor" href="#1-MongoDB-Atlas"></a>1. MongoDB Atlas</h4>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å…¨æ‰˜ç®¡æ–‡æ¡£æ•°æ®åº“æœåŠ¡</li>
<li>è‡ªåŠ¨åˆ†ç‰‡å’Œè´Ÿè½½å‡è¡¡</li>
<li>å†…ç½®ç›‘æ§å’Œè­¦æŠ¥</li>
<li>å¤šåŒºåŸŸå…¨çƒé›†ç¾¤é€‰é¡¹</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>éœ€è¦çµæ´»æ¨¡å¼çš„åº”ç”¨</li>
<li>å†…å®¹ç®¡ç†å’Œç›®å½•</li>
<li>å®æ—¶åˆ†æå’Œç‰©è”ç½‘æ•°æ®</li>
</ul>
<p><strong>éƒ¨ç½²ç¤ºä¾‹</strong>(ä½¿ç”¨Atlas Operator)ï¼š</p>
<pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">atlas.mongodb.com/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">AtlasCluster</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">my-atlas-cluster</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">projectRef:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">my-project</span>
  <span class="hljs-attr">clusterSpec:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">&quot;MyClusterName&quot;</span>
    <span class="hljs-attr">providerSettings:</span>
      <span class="hljs-attr">instanceSizeName:</span> <span class="hljs-string">M10</span>
      <span class="hljs-attr">providerName:</span> <span class="hljs-string">AWS</span>
      <span class="hljs-attr">regionName:</span> <span class="hljs-string">US_EAST_1</span>
    <span class="hljs-attr">mongoDBMajorVersion:</span> <span class="hljs-string">&quot;5.0&quot;</span>
    <span class="hljs-attr">diskSizeGB:</span> <span class="hljs-number">10</span>
    <span class="hljs-attr">replicationSpecs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">numShards:</span> <span class="hljs-number">1</span>
        <span class="hljs-attr">regionsConfig:</span>
          <span class="hljs-attr">US_EAST_1:</span>
            <span class="hljs-attr">readOnlyNodes:</span> <span class="hljs-number">0</span>
            <span class="hljs-attr">analyticsNodes:</span> <span class="hljs-number">0</span>
            <span class="hljs-attr">electableNodes:</span> <span class="hljs-number">3</span>
            <span class="hljs-attr">priority:</span> <span class="hljs-number">7</span></code></pre>
<h4 id="2-Amazon-DynamoDB"><a class="header-anchor" href="#2-Amazon-DynamoDB"></a>2. Amazon DynamoDB</h4>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å®Œå…¨æ‰˜ç®¡çš„é”®å€¼å’Œæ–‡æ¡£æ•°æ®åº“</li>
<li>æ— é™æ‰©å±•ï¼Œå•ä½æ¯«ç§’çº§å»¶è¿Ÿ</li>
<li>æŒ‰éœ€å®¹é‡æ¨¡å¼</li>
<li>å…¨å±€è¡¨å®ç°å¤šåŒºåŸŸå¤åˆ¶</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>é«˜ååä½å»¶è¿Ÿè¦æ±‚</li>
<li>æ— æœåŠ¡å™¨å’Œäº‹ä»¶é©±åŠ¨æ¶æ„</li>
<li>ä¼šè¯å­˜å‚¨å’Œè´­ç‰©è½¦</li>
</ul>
<p><strong>é…ç½®ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs terraform">resource &quot;aws_dynamodb_table&quot; &quot;basic-dynamodb-table&quot; &#123;
  name           &#x3D; &quot;GameScores&quot;
  billing_mode   &#x3D; &quot;PAY_PER_REQUEST&quot;
  hash_key       &#x3D; &quot;UserId&quot;
  range_key      &#x3D; &quot;GameTitle&quot;

  attribute &#123;
    name &#x3D; &quot;UserId&quot;
    type &#x3D; &quot;S&quot;
  &#125;

  attribute &#123;
    name &#x3D; &quot;GameTitle&quot;
    type &#x3D; &quot;S&quot;
  &#125;

  replica &#123;
    region_name &#x3D; &quot;us-east-2&quot;
  &#125;

  replica &#123;
    region_name &#x3D; &quot;us-west-1&quot;
  &#125;

  ttl &#123;
    attribute_name &#x3D; &quot;TimeToExist&quot;
    enabled        &#x3D; true
  &#125;

  point_in_time_recovery &#123;
    enabled &#x3D; true
  &#125;
&#125;</code></pre>
<h4 id="3-ScyllaDB"><a class="header-anchor" href="#3-ScyllaDB"></a>3. ScyllaDB</h4>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å…¼å®¹Cassandraçš„é«˜æ€§èƒ½NoSQLæ•°æ®åº“</li>
<li>C++å®ç°ï¼Œæ¯”Cassandraé«˜10å€æ€§èƒ½</li>
<li>è‡ªåŠ¨åˆ†ç‰‡å’Œå†å¹³è¡¡</li>
<li>å¤šæ•°æ®ä¸­å¿ƒå¤åˆ¶</li>
</ul>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p>
<ul>
<li>æ—¶åºæ•°æ®å’ŒIoT</li>
<li>é«˜å†™å…¥ååé‡åœºæ™¯</li>
<li>å¤§è§„æ¨¡åˆ†æå’Œæ—¥å¿—å­˜å‚¨</li>
</ul>
<p><strong>Kubernetes Operatoréƒ¨ç½²</strong>ï¼š</p>
<pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">scylla.scylladb.com/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">ScyllaCluster</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">scylla-cluster</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">scylla</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">version:</span> <span class="hljs-number">5.0</span><span class="hljs-number">.0</span>
  <span class="hljs-attr">repository:</span> <span class="hljs-string">scylladb/scylla</span>
  <span class="hljs-attr">cpuset:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">datacenter:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">dc1</span>
    <span class="hljs-attr">racks:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">rack1</span>
      <span class="hljs-attr">members:</span> <span class="hljs-number">3</span>
      <span class="hljs-attr">storage:</span>
        <span class="hljs-attr">capacity:</span> <span class="hljs-string">100Gi</span>
        <span class="hljs-attr">storageClassName:</span> <span class="hljs-string">local-storage</span>
      <span class="hljs-attr">resources:</span>
        <span class="hljs-attr">requests:</span>
          <span class="hljs-attr">cpu:</span> <span class="hljs-number">1</span>
          <span class="hljs-attr">memory:</span> <span class="hljs-string">8Gi</span>
        <span class="hljs-attr">limits:</span>
          <span class="hljs-attr">cpu:</span> <span class="hljs-number">2</span>
          <span class="hljs-attr">memory:</span> <span class="hljs-string">16Gi</span></code></pre>
<h2 id="ğŸš€-éƒ¨ç½²ä¸ç®¡ç†æœ€ä½³å®è·µ"><a class="header-anchor" href="#ğŸš€-éƒ¨ç½²ä¸ç®¡ç†æœ€ä½³å®è·µ"></a>ğŸš€ éƒ¨ç½²ä¸ç®¡ç†æœ€ä½³å®è·µ</h2>
<h3 id="åœ¨Kubernetesä¸Šéƒ¨ç½²æ•°æ®åº“"><a class="header-anchor" href="#åœ¨Kubernetesä¸Šéƒ¨ç½²æ•°æ®åº“"></a>åœ¨Kubernetesä¸Šéƒ¨ç½²æ•°æ®åº“</h3>
<p>Kuberneteså·²æˆä¸ºäº‘åŸç”Ÿåº”ç”¨çš„æ ‡å‡†å¹³å°ï¼Œä½†æ•°æ®åº“éƒ¨ç½²éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š</p>
<h4 id="1-ä½¿ç”¨Operatoræ¨¡å¼"><a class="header-anchor" href="#1-ä½¿ç”¨Operatoræ¨¡å¼"></a>1. ä½¿ç”¨Operatoræ¨¡å¼</h4>
<p>Operatoræ¨¡å¼æ˜¯åœ¨K8sä¸Šç®¡ç†æœ‰çŠ¶æ€åº”ç”¨çš„æœ€ä½³å®è·µï¼š</p>
<pre><code class="hljs yaml"><span class="hljs-comment"># PostgreSQLä½¿ç”¨Zalando Operatorç¤ºä¾‹</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">acid.zalan.do/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">postgresql</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">acid-postgres-cluster</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">teamId:</span> <span class="hljs-string">&quot;data&quot;</span>
  <span class="hljs-attr">volume:</span>
    <span class="hljs-attr">size:</span> <span class="hljs-string">10Gi</span>
  <span class="hljs-attr">numberOfInstances:</span> <span class="hljs-number">3</span>
  <span class="hljs-attr">users:</span>
    <span class="hljs-attr">admin:</span>  <span class="hljs-comment"># æ•°æ®åº“è¶…çº§ç”¨æˆ·</span>
      <span class="hljs-attr">password:</span> <span class="hljs-string">postgres</span>
      <span class="hljs-attr">options:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">createdb</span>
  <span class="hljs-attr">postgresql:</span>
    <span class="hljs-attr">version:</span> <span class="hljs-string">&quot;14&quot;</span>
    <span class="hljs-attr">parameters:</span>
      <span class="hljs-attr">shared_buffers:</span> <span class="hljs-string">&quot;256MB&quot;</span>
      <span class="hljs-attr">max_connections:</span> <span class="hljs-string">&quot;200&quot;</span>
  <span class="hljs-attr">patroni:</span>
    <span class="hljs-attr">ttl:</span> <span class="hljs-number">30</span>
    <span class="hljs-attr">loop_wait:</span> <span class="hljs-number">10</span>
    <span class="hljs-attr">retry_timeout:</span> <span class="hljs-number">10</span>
    <span class="hljs-attr">synchronous_mode:</span> <span class="hljs-literal">true</span></code></pre>
<p>å¸¸ç”¨çš„æ•°æ®åº“Operatorï¼š</p>
<ul>
<li>Zalando Postgres Operator</li>
<li>Percona Operator for MySQL/MongoDB</li>
<li>Redis Operator by Spotahome</li>
<li>CockroachDB Operator</li>
<li>YugabyteDB Operator</li>
</ul>
<h4 id="2-å­˜å‚¨é…ç½®"><a class="header-anchor" href="#2-å­˜å‚¨é…ç½®"></a>2. å­˜å‚¨é…ç½®</h4>
<p>ä¸ºæ•°æ®åº“é€‰æ‹©åˆé€‚çš„å­˜å‚¨ç±»å‹ï¼š</p>
<pre><code class="hljs yaml"><span class="hljs-comment"># ä¸ºMongoDBåˆ›å»ºStorageClass</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">storage.k8s.io/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">StorageClass</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">mongodb-storage</span>
<span class="hljs-attr">provisioner:</span> <span class="hljs-string">kubernetes.io/aws-ebs</span>
<span class="hljs-attr">parameters:</span>
  <span class="hljs-attr">type:</span> <span class="hljs-string">io1</span>
  <span class="hljs-attr">iopsPerGB:</span> <span class="hljs-string">&quot;50&quot;</span>
  <span class="hljs-attr">encrypted:</span> <span class="hljs-string">&quot;true&quot;</span>
<span class="hljs-attr">volumeBindingMode:</span> <span class="hljs-string">WaitForFirstConsumer</span></code></pre>
<p>å­˜å‚¨ç±»å‹é€‰æ‹©æŒ‡å—ï¼š</p>
<ul>
<li><strong>SSD/NVMe</strong>ï¼šå¯¹äºOLTPå·¥ä½œè´Ÿè½½</li>
<li><strong>é«˜IOPSå­˜å‚¨</strong>ï¼šå¯¹äºå†™å…¥å¯†é›†å‹åº”ç”¨</li>
<li><strong>æœ¬åœ°å­˜å‚¨</strong>ï¼šè·å¾—æœ€ä½å»¶è¿Ÿ(æ³¨æ„é«˜å¯ç”¨æ€§è®¾è®¡)</li>
<li><strong>ç½‘ç»œå­˜å‚¨</strong>ï¼šç®€åŒ–å¤‡ä»½å’Œå¯ç”¨æ€§</li>
</ul>
<h4 id="3-èµ„æºé…ç½®"><a class="header-anchor" href="#3-èµ„æºé…ç½®"></a>3. èµ„æºé…ç½®</h4>
<p>ä¸ºæ•°æ®åº“Podåˆ†é…è¶³å¤Ÿä¸”éš”ç¦»çš„èµ„æºï¼š</p>
<pre><code class="hljs yaml"><span class="hljs-attr">resources:</span>
  <span class="hljs-attr">requests:</span>
    <span class="hljs-attr">cpu:</span> <span class="hljs-number">2</span>
    <span class="hljs-attr">memory:</span> <span class="hljs-string">4Gi</span>
  <span class="hljs-attr">limits:</span>
    <span class="hljs-attr">cpu:</span> <span class="hljs-number">4</span>
    <span class="hljs-attr">memory:</span> <span class="hljs-string">8Gi</span></code></pre>
<p>ä¼˜å…ˆçº§è®¾ç½®ç¡®ä¿æ•°æ®åº“podæ›´ç¨³å®šï¼š</p>
<pre><code class="hljs yaml"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">scheduling.k8s.io/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">PriorityClass</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">high-priority-database</span>
<span class="hljs-attr">value:</span> <span class="hljs-number">1000000</span>
<span class="hljs-attr">globalDefault:</span> <span class="hljs-literal">false</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">&quot;é«˜ä¼˜å…ˆçº§æ•°æ®åº“workload&quot;</span></code></pre>
<h4 id="4-äº²å’Œæ€§ä¸åäº²å’Œæ€§"><a class="header-anchor" href="#4-äº²å’Œæ€§ä¸åäº²å’Œæ€§"></a>4. äº²å’Œæ€§ä¸åäº²å’Œæ€§</h4>
<p>ç¡®ä¿æ•°æ®åº“è·¨èŠ‚ç‚¹åˆ†å¸ƒæé«˜å¯ç”¨æ€§ï¼š</p>
<pre><code class="hljs yaml"><span class="hljs-attr">affinity:</span>
  <span class="hljs-attr">podAntiAffinity:</span>
    <span class="hljs-attr">requiredDuringSchedulingIgnoredDuringExecution:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">labelSelector:</span>
          <span class="hljs-attr">matchExpressions:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">key:</span> <span class="hljs-string">app</span>
              <span class="hljs-attr">operator:</span> <span class="hljs-string">In</span>
              <span class="hljs-attr">values:</span>
                <span class="hljs-bullet">-</span> <span class="hljs-string">mongodb</span>
        <span class="hljs-attr">topologyKey:</span> <span class="hljs-string">&quot;kubernetes.io/hostname&quot;</span></code></pre>
<h3 id="å¤‡ä»½ä¸æ¢å¤ç­–ç•¥"><a class="header-anchor" href="#å¤‡ä»½ä¸æ¢å¤ç­–ç•¥"></a>å¤‡ä»½ä¸æ¢å¤ç­–ç•¥</h3>
<p>äº‘åŸç”Ÿæ•°æ®åº“çš„å¤‡ä»½ç­–ç•¥ï¼š</p>
<h4 id="1-Veleroå¤‡ä»½"><a class="header-anchor" href="#1-Veleroå¤‡ä»½"></a>1. Veleroå¤‡ä»½</h4>
<pre><code class="hljs bash"><span class="hljs-comment"># å®‰è£…Velero</span>
velero install \
    --provider aws \
    --plugins velero/velero-plugin-for-aws:v1.4.0 \
    --bucket my-backup-bucket \
    --backup-location-config region=us-east-1 \
    --snapshot-location-config region=us-east-1 \
    --secret-file ./credentials-velero

<span class="hljs-comment"># åˆ›å»ºå®šæ—¶å¤‡ä»½</span>
velero create schedule pg-daily \
    --schedule=<span class="hljs-string">&quot;0 1 * * *&quot;</span> \
    --include-namespaces postgres-ns</code></pre>
<h4 id="2-æ•°æ®åº“åŸç”Ÿå¤‡ä»½"><a class="header-anchor" href="#2-æ•°æ®åº“åŸç”Ÿå¤‡ä»½"></a>2. æ•°æ®åº“åŸç”Ÿå¤‡ä»½</h4>
<p>å¤§å¤šæ•°æ•°æ®åº“Operatoræä¾›å†…ç½®å¤‡ä»½åŠŸèƒ½ï¼š</p>
<pre><code class="hljs yaml"><span class="hljs-comment"># PostgreSQL Zalandoå¤‡ä»½ç¤ºä¾‹</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">acid.zalan.do/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">OperatorConfiguration</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">postgresql-operator-configuration</span>
<span class="hljs-attr">configuration:</span>
  <span class="hljs-attr">aws_or_gcp:</span>
    <span class="hljs-attr">aws_region:</span> <span class="hljs-string">eu-central-1</span>
    <span class="hljs-attr">kube_iam_role:</span> <span class="hljs-string">&quot;postgres-operator-role&quot;</span>
    <span class="hljs-attr">log_s3_bucket:</span> <span class="hljs-string">&quot;my-postgres-backup-bucket&quot;</span>
  <span class="hljs-attr">logical_backup:</span>
    <span class="hljs-attr">logical_backup_docker_image:</span> <span class="hljs-string">&quot;registry.opensource.zalan.do/acid/logical-backup&quot;</span>
    <span class="hljs-attr">logical_backup_s3_bucket:</span> <span class="hljs-string">&quot;my-postgres-backup-bucket&quot;</span>
    <span class="hljs-attr">logical_backup_s3_region:</span> <span class="hljs-string">&quot;eu-central-1&quot;</span>
    <span class="hljs-attr">logical_backup_s3_endpoint:</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-attr">logical_backup_s3_access_key_id:</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-attr">logical_backup_s3_secret_access_key:</span> <span class="hljs-string">&quot;&quot;</span>
    <span class="hljs-attr">logical_backup_s3_sse:</span> <span class="hljs-string">&quot;AES256&quot;</span>
    <span class="hljs-attr">logical_backup_schedule:</span> <span class="hljs-string">&quot;30 00 * * *&quot;</span></code></pre>
<h4 id="3-æ•°æ®æ¢å¤ç­–ç•¥"><a class="header-anchor" href="#3-æ•°æ®æ¢å¤ç­–ç•¥"></a>3. æ•°æ®æ¢å¤ç­–ç•¥</h4>
<p>è¿›è¡Œæµ‹è¯•æ¢å¤æ¼”ç»ƒååˆ†é‡è¦ï¼š</p>
<pre><code class="hljs bash"><span class="hljs-comment"># ä½¿ç”¨Veleroæ¢å¤</span>
velero restore create --from-backup pg-backup-20230315

<span class="hljs-comment"># ä¸ºæ¢å¤æ¼”ç»ƒåˆ›å»ºæ–°namespace</span>
kubectl create ns recovery-test
velero restore create \
    --from-backup pg-backup-20230315 \
    --include-namespaces postgres-ns \
    --namespace-mappings postgres-ns:recovery-test</code></pre>
<p>æ¢å¤å®è·µå»ºè®®ï¼š</p>
<ul>
<li>æ¯å­£åº¦è‡³å°‘æµ‹è¯•ä¸€æ¬¡æ¢å¤æµç¨‹</li>
<li>æµ‹é‡æ¢å¤æ—¶é—´ç›®æ ‡(RTO)è¾¾æˆæƒ…å†µ</li>
<li>éªŒè¯æ¢å¤åçš„æ•°æ®å®Œæ•´æ€§</li>
<li>è‡ªåŠ¨åŒ–æ¢å¤æµç¨‹å‡å°‘äººä¸ºé”™è¯¯</li>
</ul>
<h2 id="ğŸ”§-æ€§èƒ½ä¼˜åŒ–ä¸ç›‘æ§"><a class="header-anchor" href="#ğŸ”§-æ€§èƒ½ä¼˜åŒ–ä¸ç›‘æ§"></a>ğŸ”§ æ€§èƒ½ä¼˜åŒ–ä¸ç›‘æ§</h2>
<h3 id="æ•°æ®åº“æ€§èƒ½è°ƒä¼˜"><a class="header-anchor" href="#æ•°æ®åº“æ€§èƒ½è°ƒä¼˜"></a>æ•°æ®åº“æ€§èƒ½è°ƒä¼˜</h3>
<p>ä¸åŒäº‘åŸç”Ÿæ•°æ®åº“çš„æ€§èƒ½è°ƒä¼˜ç‚¹ï¼š</p>
<h4 id="1-PostgreSQLäº‘åŸç”Ÿè°ƒä¼˜"><a class="header-anchor" href="#1-PostgreSQLäº‘åŸç”Ÿè°ƒä¼˜"></a>1. PostgreSQLäº‘åŸç”Ÿè°ƒä¼˜</h4>
<pre><code class="hljs yaml"><span class="hljs-comment"># PostgreSQLäº‘ç¯å¢ƒå‚æ•°è°ƒä¼˜</span>
<span class="hljs-attr">postgresql:</span>
  <span class="hljs-attr">parameters:</span>
    <span class="hljs-attr">shared_buffers:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; 0.25 * memory_size &#125;&#125;</span>MB&quot;</span>
    <span class="hljs-attr">effective_cache_size:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; 0.75 * memory_size &#125;&#125;</span>MB&quot;</span>
    <span class="hljs-attr">maintenance_work_mem:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; 0.05 * memory_size &#125;&#125;</span>MB&quot;</span>
    <span class="hljs-attr">work_mem:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; (0.25 * memory_size) / max_connections &#125;&#125;</span>MB&quot;</span>
    
    <span class="hljs-comment"># å†™å…¥ä¼˜åŒ–</span>
    <span class="hljs-attr">wal_buffers:</span> <span class="hljs-string">16MB</span>
    <span class="hljs-attr">checkpoint_timeout:</span> <span class="hljs-string">15min</span>
    <span class="hljs-attr">checkpoint_completion_target:</span> <span class="hljs-number">0.9</span>
    
    <span class="hljs-comment"># å¹¶è¡ŒæŸ¥è¯¢ä¼˜åŒ–</span>
    <span class="hljs-attr">max_worker_processes:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; cpu_count &#125;&#125;</span>&quot;</span>
    <span class="hljs-attr">max_parallel_workers_per_gather:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; cpu_count / 2 &#125;&#125;</span>&quot;</span>
    <span class="hljs-attr">max_parallel_workers:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; cpu_count &#125;&#125;</span>&quot;</span>
    
    <span class="hljs-comment"># è‡ªåŠ¨vacuumä¼˜åŒ–</span>
    <span class="hljs-attr">autovacuum_vacuum_scale_factor:</span> <span class="hljs-number">0.05</span>
    <span class="hljs-attr">autovacuum_analyze_scale_factor:</span> <span class="hljs-number">0.025</span></code></pre>
<h4 id="2-MongoDBæ€§èƒ½ä¼˜åŒ–"><a class="header-anchor" href="#2-MongoDBæ€§èƒ½ä¼˜åŒ–"></a>2. MongoDBæ€§èƒ½ä¼˜åŒ–</h4>
<pre><code class="hljs yaml"><span class="hljs-comment"># MongoDBäº‘ç¯å¢ƒå‚æ•°è°ƒä¼˜</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">mongodsidecar:</span>
    <span class="hljs-attr">resources:</span>
      <span class="hljs-attr">limits:</span>
        <span class="hljs-attr">cpu:</span> <span class="hljs-string">&quot;4&quot;</span>
        <span class="hljs-attr">memory:</span> <span class="hljs-string">8Gi</span>
  <span class="hljs-attr">mongod:</span>
    <span class="hljs-attr">net:</span>
      <span class="hljs-attr">port:</span> <span class="hljs-number">27017</span>
    <span class="hljs-attr">operationProfiling:</span>
      <span class="hljs-attr">mode:</span> <span class="hljs-string">slowOp</span>
      <span class="hljs-attr">slowOpThresholdMs:</span> <span class="hljs-number">100</span>
    <span class="hljs-attr">replication:</span>
      <span class="hljs-attr">oplogSizeMB:</span> <span class="hljs-number">2048</span>
    <span class="hljs-attr">storage:</span>
      <span class="hljs-attr">wiredTiger:</span>
        <span class="hljs-attr">engineConfig:</span>
          <span class="hljs-attr">cacheSizeRatio:</span> <span class="hljs-number">0.5</span>
        <span class="hljs-attr">collectionConfig:</span>
          <span class="hljs-attr">blockCompressor:</span> <span class="hljs-string">snappy</span></code></pre>
<h4 id="3-Redisé›†ç¾¤ä¼˜åŒ–"><a class="header-anchor" href="#3-Redisé›†ç¾¤ä¼˜åŒ–"></a>3. Redisé›†ç¾¤ä¼˜åŒ–</h4>
<pre><code class="hljs yaml"><span class="hljs-comment"># Redisé›†ç¾¤é…ç½®ä¼˜åŒ–</span>
<span class="hljs-attr">redis:</span>
  <span class="hljs-attr">config:</span>
    <span class="hljs-comment"># å†…å­˜ç®¡ç†</span>
    <span class="hljs-attr">maxmemory:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; memory_size * 0.75 &#125;&#125;</span>mb&quot;</span>
    <span class="hljs-attr">maxmemory-policy:</span> <span class="hljs-string">&quot;volatile-lru&quot;</span>
    
    <span class="hljs-comment"># æŒä¹…åŒ–è®¾ç½®</span>
    <span class="hljs-attr">appendonly:</span> <span class="hljs-string">&quot;yes&quot;</span>
    <span class="hljs-attr">appendfsync:</span> <span class="hljs-string">&quot;everysec&quot;</span>
    
    <span class="hljs-comment"># é›†ç¾¤è®¾ç½®</span>
    <span class="hljs-attr">cluster-enabled:</span> <span class="hljs-string">&quot;yes&quot;</span>
    <span class="hljs-attr">cluster-node-timeout:</span> <span class="hljs-number">5000</span>
    
    <span class="hljs-comment"># æ€§èƒ½ä¼˜åŒ–</span>
    <span class="hljs-attr">io-threads:</span> <span class="hljs-number">4</span>
    <span class="hljs-attr">io-threads-do-reads:</span> <span class="hljs-string">&quot;yes&quot;</span>
    <span class="hljs-attr">activedefrag:</span> <span class="hljs-string">&quot;yes&quot;</span></code></pre>
<h3 id="ç›‘æ§ä½“ç³»å»ºè®¾"><a class="header-anchor" href="#ç›‘æ§ä½“ç³»å»ºè®¾"></a>ç›‘æ§ä½“ç³»å»ºè®¾</h3>
<p>å®Œæ•´çš„ç›‘æ§ç­–ç•¥åŒ…æ‹¬ï¼š</p>
<h4 id="1-Prometheusç›‘æ§"><a class="header-anchor" href="#1-Prometheusç›‘æ§"></a>1. Prometheusç›‘æ§</h4>
<pre><code class="hljs yaml"><span class="hljs-comment"># PostgreSQLç›‘æ§é…ç½®</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">monitoring.coreos.com/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">ServiceMonitor</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">postgres-exporter</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">monitoring</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">matchLabels:</span>
      <span class="hljs-attr">app:</span> <span class="hljs-string">postgres-exporter</span>
  <span class="hljs-attr">endpoints:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-string">metrics</span>
    <span class="hljs-attr">interval:</span> <span class="hljs-string">30s</span>
    <span class="hljs-attr">scrapeTimeout:</span> <span class="hljs-string">10s</span></code></pre>
<h4 id="2-Grafanaä»ªè¡¨æ¿"><a class="header-anchor" href="#2-Grafanaä»ªè¡¨æ¿"></a>2. Grafanaä»ªè¡¨æ¿</h4>
<p>åˆ›å»ºåŒ…å«ä»¥ä¸‹æŒ‡æ ‡çš„ä»ªè¡¨æ¿ï¼š</p>
<ul>
<li>è¿æ¥æ•°å’Œè¿æ¥ä½¿ç”¨ç‡</li>
<li>æŸ¥è¯¢ååé‡å’Œå»¶è¿Ÿ</li>
<li>ç¼“å­˜å‘½ä¸­ç‡</li>
<li>å­˜å‚¨ä½¿ç”¨å’Œå¢é•¿ç‡</li>
<li>å‰¯æœ¬å»¶è¿Ÿ(å¦‚é€‚ç”¨)</li>
<li>CPUå’Œå†…å­˜ä½¿ç”¨ç‡</li>
</ul>
<h4 id="3-å‘Šè­¦é…ç½®"><a class="header-anchor" href="#3-å‘Šè­¦é…ç½®"></a>3. å‘Šè­¦é…ç½®</h4>
<pre><code class="hljs yaml"><span class="hljs-comment"># æ•°æ®åº“å‘Šè­¦è§„åˆ™</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">monitoring.coreos.com/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">PrometheusRule</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">database-alerts</span>
  <span class="hljs-attr">namespace:</span> <span class="hljs-string">monitoring</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">groups:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">database.rules</span>
    <span class="hljs-attr">rules:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">PostgresqlHighConnections</span>
      <span class="hljs-attr">expr:</span> <span class="hljs-string">sum(pg_stat_activity_count)</span> <span class="hljs-string">by</span> <span class="hljs-string">(datname)</span> <span class="hljs-string">&gt;</span> <span class="hljs-string">pg_settings_max_connections</span> <span class="hljs-string">*</span> <span class="hljs-number">0.8</span>
      <span class="hljs-attr">for:</span> <span class="hljs-string">5m</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">severity:</span> <span class="hljs-string">warning</span>
      <span class="hljs-attr">annotations:</span>
        <span class="hljs-attr">summary:</span> <span class="hljs-string">&quot;æ•°æ®åº“è¿æ¥æ•°æ¥è¿‘æœ€å¤§å€¼&quot;</span>
        <span class="hljs-attr">description:</span> <span class="hljs-string">&quot;æ•°æ®åº“ <span class="hljs-template-variable">&#123;&#123; $labels.datname &#125;&#125;</span> ä½¿ç”¨äº†è¶…è¿‡80%çš„å¯ç”¨è¿æ¥&quot;</span>
    
    <span class="hljs-bullet">-</span> <span class="hljs-attr">alert:</span> <span class="hljs-string">PostgresqlReplicationLag</span>
      <span class="hljs-attr">expr:</span> <span class="hljs-string">pg_stat_replication_lag_bytes</span> <span class="hljs-string">&gt;</span> <span class="hljs-number">100000000</span>
      <span class="hljs-attr">for:</span> <span class="hljs-string">5m</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">severity:</span> <span class="hljs-string">warning</span>
      <span class="hljs-attr">annotations:</span>
        <span class="hljs-attr">summary:</span> <span class="hljs-string">&quot;å¤åˆ¶å»¶è¿Ÿè¿‡å¤§&quot;</span>
        <span class="hljs-attr">description:</span> <span class="hljs-string">&quot;PostgreSQLå¤åˆ¶å»¶è¿Ÿè¶…è¿‡100MBæŒç»­5åˆ†é’Ÿ&quot;</span></code></pre>
<h2 id="ğŸ’¼-æ¡ˆä¾‹ç ”ç©¶ï¼šç”µå•†å¹³å°æ•°æ®åº“è¿ç§»"><a class="header-anchor" href="#ğŸ’¼-æ¡ˆä¾‹ç ”ç©¶ï¼šç”µå•†å¹³å°æ•°æ®åº“è¿ç§»"></a>ğŸ’¼ æ¡ˆä¾‹ç ”ç©¶ï¼šç”µå•†å¹³å°æ•°æ®åº“è¿ç§»</h2>
<p>ä»¥ä¸‹æ˜¯æˆ‘å‚ä¸çš„ä¸€ä¸ªçœŸå®é¡¹ç›®æ¡ˆä¾‹ï¼Œå°†ä¸€ä¸ªä¼ ç»Ÿç”µå•†å¹³å°æ•°æ®åº“è¿ç§»åˆ°äº‘åŸç”Ÿæ¶æ„ã€‚</p>
<h3 id="èµ·å§‹çŠ¶å†µ"><a class="header-anchor" href="#èµ·å§‹çŠ¶å†µ"></a>èµ·å§‹çŠ¶å†µ</h3>
<ul>
<li>å•ä½“MySQLæ•°æ®åº“(8TBæ•°æ®)</li>
<li>é«˜å³°æœŸæŸ¥è¯¢å»¶è¿Ÿä¸¥é‡</li>
<li>ç»´æŠ¤çª—å£è¶Šæ¥è¶Šéš¾å®‰æ’</li>
<li>æ‰©å±•æ€§å—é™</li>
</ul>
<h3 id="ç›®æ ‡æ¶æ„è®¾è®¡"><a class="header-anchor" href="#ç›®æ ‡æ¶æ„è®¾è®¡"></a>ç›®æ ‡æ¶æ„è®¾è®¡</h3>
<p>ç»è¿‡è¯„ä¼°ï¼Œæˆ‘ä»¬è®¾è®¡äº†æ··åˆæ•°æ®åº“æ¶æ„ï¼š</p>
<ol>
<li>
<p><strong>æ ¸å¿ƒäº¤æ˜“æ•°æ®</strong>ï¼šCockroachDBé›†ç¾¤</p>
<ul>
<li>è·¨åŒºåŸŸåˆ†å¸ƒï¼Œå¼ºä¸€è‡´æ€§</li>
<li>è‰¯å¥½çš„æ°´å¹³æ‰©å±•æ€§</li>
<li>SQLå…¼å®¹æ€§é™ä½è¿ç§»å¤æ‚åº¦</li>
</ul>
</li>
<li>
<p><strong>äº§å“ç›®å½•</strong>ï¼šMongoDB Atlas</p>
<ul>
<li>é€‚åˆé¢‘ç¹å˜åŒ–çš„äº§å“å±æ€§</li>
<li>æ–‡æ¡£æ¨¡å‹åŒ¹é…äº§å“æ•°æ®ç»“æ„</li>
<li>å…¨æ–‡æœç´¢èƒ½åŠ›</li>
</ul>
</li>
<li>
<p><strong>ç”¨æˆ·ä¼šè¯å’Œç¼“å­˜</strong>ï¼šRedisé›†ç¾¤</p>
<ul>
<li>ç”¨äºä¼šè¯å­˜å‚¨å’ŒAPIç¼“å­˜</li>
<li>å‡è½»ä¸»æ•°æ®åº“è´Ÿæ‹…</li>
</ul>
</li>
<li>
<p><strong>åˆ†ææ•°æ®</strong>ï¼šAmazon Redshift</p>
<ul>
<li>ç”¨äºæŠ¥è¡¨å’Œæ•°æ®åˆ†æ</li>
<li>é€šè¿‡CDCä»ä¸»æ•°æ®æºåŒæ­¥</li>
</ul>
</li>
</ol>
<h3 id="è¿ç§»ç­–ç•¥"><a class="header-anchor" href="#è¿ç§»ç­–ç•¥"></a>è¿ç§»ç­–ç•¥</h3>
<p>æˆ‘ä»¬é‡‡ç”¨äº†åŒå†™+å¢é‡åŒæ­¥çš„ç­–ç•¥ï¼š</p>
<pre><code class="hljs go"><span class="hljs-comment">// ä¼ªä»£ç ï¼šåŒå†™é€»è¾‘</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">WriteOrder</span><span class="hljs-params">(order Order)</span> <span class="hljs-title">error</span></span> &#123;
    <span class="hljs-comment">// å†™å…¥æ—§æ•°æ®åº“</span>
    err := legacyDB.InsertOrder(order)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;
        <span class="hljs-keyword">return</span> err
    &#125;
    
    <span class="hljs-comment">// å†™å…¥æ–°æ•°æ®åº“(å¼‚æ­¥)</span>
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> &#123;
        err := cockroachDB.InsertOrder(order)
        <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;
            <span class="hljs-comment">// è®°å½•é”™è¯¯ï¼Œç¨åé‡è¯•</span>
            errorQueue.Push(WriteTask&#123;
                Type: <span class="hljs-string">&quot;order&quot;</span>,
                Data: order,
            &#125;)
        &#125;
    &#125;()
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
&#125;</code></pre>
<p>æ•°æ®è¿ç§»å·¥å…·ï¼š</p>
<pre><code class="hljs bash"><span class="hljs-comment"># ä½¿ç”¨pg_dumpå¯¼å‡ºæ•°æ®</span>
pg_dump -h old-db -U admin -d commerce -t orders &gt; orders.sql

<span class="hljs-comment"># å¹¶è¡Œå¯¼å…¥CockroachDB</span>
cat orders.sql | \
  cockroach sql \
  --insecure \
  --host=cockroachdb-public \
  --database=commerce</code></pre>
<h3 id="é‡åˆ°çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ"><a class="header-anchor" href="#é‡åˆ°çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ"></a>é‡åˆ°çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ol>
<li>
<p><strong>Schemaå…¼å®¹æ€§é—®é¢˜</strong></p>
<ul>
<li>MySQLå’ŒCockroachDBçš„ç±»å‹å·®å¼‚</li>
<li>è§£å†³ï¼šåˆ›å»ºè½¬æ¢å±‚å’Œè¿ç§»æµ‹è¯•å¥—ä»¶</li>
</ul>
</li>
<li>
<p><strong>æ•°æ®ä¸€è‡´æ€§éªŒè¯</strong></p>
<ul>
<li>è§£å†³ï¼šå¼€å‘æ ¡éªŒå·¥å…·æ¯”è¾ƒæ–°æ—§æ•°æ®åº“</li>
</ul>
<pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">verify_consistency</span>(<span class="hljs-params">table, batch_size=<span class="hljs-number">1000</span></span>):</span>
 offset = <span class="hljs-number">0</span>
 <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
     old_records = query_old_db(<span class="hljs-string">f&quot;SELECT * FROM <span class="hljs-subst">&#123;table&#125;</span> LIMIT <span class="hljs-subst">&#123;batch_size&#125;</span> OFFSET <span class="hljs-subst">&#123;offset&#125;</span>&quot;</span>)
     <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> old_records:
         <span class="hljs-keyword">break</span>
         
     <span class="hljs-keyword">for</span> record <span class="hljs-keyword">in</span> old_records:
         new_record = query_new_db(<span class="hljs-string">f&quot;SELECT * FROM <span class="hljs-subst">&#123;table&#125;</span> WHERE id = <span class="hljs-subst">&#123;record[<span class="hljs-string">&#x27;id&#x27;</span>]&#125;</span>&quot;</span>)
         <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> records_match(record, new_record):
             log_mismatch(table, record[<span class="hljs-string">&#x27;id&#x27;</span>])
     
     offset += batch_size</code></pre>
</li>
<li>
<p><strong>æ€§èƒ½è°ƒä¼˜</strong></p>
<ul>
<li>CockroachDBç´¢å¼•ç­–ç•¥è°ƒæ•´</li>
<li>è§£å†³ï¼šåŸºäºæŸ¥è¯¢æ¨¡å¼åˆ›å»ºäºŒçº§ç´¢å¼•</li>
</ul>
<pre><code class="hljs sql"><span class="hljs-comment">-- ä¸ºçƒ­ç‚¹æŸ¥è¯¢åˆ›å»ºè¦†ç›–ç´¢å¼•</span>
</li>
</ol>
<p><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_orders_customer_date <span class="hljs-keyword">ON</span> orders (customer_id, order_date)<br>
STORING (<span class="hljs-keyword">status</span>, total_amount);</code></pre>:hexoPostRenderEscapeâ€“&gt;</p>
<ol start="4">
<li><strong>åº”ç”¨å±‚é€‚é…</strong>
<ul>
<li>ä¸åŒæ•°æ®åº“é”™è¯¯å¤„ç†</li>
<li>è§£å†³ï¼šåˆ›å»ºç»Ÿä¸€çš„æ•°æ®è®¿é—®å±‚</li>
</ul>
</li>
</ol>
<h3 id="ç»“æœä¸æ”¶ç›Š"><a class="header-anchor" href="#ç»“æœä¸æ”¶ç›Š"></a>ç»“æœä¸æ”¶ç›Š</h3>
<p>è¿ç§»å®Œæˆåï¼Œæˆ‘ä»¬è·å¾—äº†æ˜¾è‘—æ”¶ç›Šï¼š</p>
<ol>
<li>
<p><strong>æ€§èƒ½æå‡</strong>ï¼š</p>
<ul>
<li>å³°å€¼æŸ¥è¯¢å»¶è¿Ÿä»200msé™è‡³30ms</li>
<li>äº‹åŠ¡ååé‡æå‡äº†3å€</li>
</ul>
</li>
<li>
<p><strong>å¯ç”¨æ€§æå‡</strong>ï¼š</p>
<ul>
<li>ä»99.95%æå‡åˆ°99.995%</li>
<li>ç»´æŠ¤æ“ä½œä¸å†éœ€è¦åœæœº</li>
</ul>
</li>
<li>
<p><strong>æˆæœ¬ä¼˜åŒ–</strong>ï¼š</p>
<ul>
<li>æ€»ä½“æ‹¥æœ‰æˆæœ¬(TCO)é™ä½äº†20%</li>
<li>èµ„æºåˆ©ç”¨ç‡ä»40%æå‡åˆ°75%</li>
</ul>
</li>
<li>
<p><strong>ä¸šåŠ¡çµæ´»æ€§</strong>ï¼š</p>
<ul>
<li>æ–°åŠŸèƒ½ä¸Šçº¿æ—¶é—´ä»å‘¨ç¼©çŸ­åˆ°å¤©</li>
<li>æ”¯æŒäº†è·¨åŒºåŸŸéƒ¨ç½²éœ€æ±‚</li>
</ul>
</li>
</ol>
<h2 id="ğŸŒŸ-æ€»ç»“ä¸å»ºè®®"><a class="header-anchor" href="#ğŸŒŸ-æ€»ç»“ä¸å»ºè®®"></a>ğŸŒŸ æ€»ç»“ä¸å»ºè®®</h2>
<p>äº‘åŸç”Ÿæ•°æ®åº“é€‰å‹æ˜¯ä¸€ä¸ªéœ€è¦ç»¼åˆè€ƒé‡çš„è¿‡ç¨‹ï¼Œæ²¡æœ‰æ”¾ä¹‹å››æµ·è€Œçš†å‡†çš„è§£å†³æ–¹æ¡ˆã€‚åŸºäºæˆ‘çš„ç»éªŒï¼Œæ¨èä»¥ä¸‹æœ€ä½³å®è·µï¼š</p>
<ol>
<li>
<p><strong>åŸºäºå®é™…éœ€æ±‚é€‰å‹</strong>ï¼šä¸è¦è¿½é€çƒ­é—¨æŠ€æœ¯ï¼Œè€Œæ˜¯æ ¹æ®å®é™…æ•°æ®æ¨¡å‹ã€ä¸€è‡´æ€§éœ€æ±‚ã€æ€§èƒ½ç‰¹å¾é€‰æ‹©åˆé€‚çš„æ•°æ®åº“</p>
</li>
<li>
<p><strong>æ··åˆç­–ç•¥ä¼˜äºå•ä¸€è§£å†³æ–¹æ¡ˆ</strong>ï¼šä¸åŒæ•°æ®é€‚åˆä¸åŒç±»å‹çš„æ•°æ®åº“ï¼Œå•ä¸€æ•°æ®åº“éš¾ä»¥æ»¡è¶³æ‰€æœ‰éœ€æ±‚</p>
</li>
<li>
<p><strong>é‡è§†æ“ä½œç®€ä¾¿æ€§</strong>ï¼šäº‘åŸç”Ÿç¯å¢ƒéœ€è¦è‡ªåŠ¨åŒ–ç¨‹åº¦é«˜çš„æ•°æ®åº“ï¼Œé¿å…éœ€è¦å¤§é‡äººå·¥å¹²é¢„çš„é€‰é¡¹</p>
</li>
<li>
<p><strong>ä»å°è§„æ¨¡å¼€å§‹</strong>ï¼šå…ˆåœ¨éå…³é”®ä¸šåŠ¡éªŒè¯æ•°æ®åº“ï¼Œç§¯ç´¯ç»éªŒåå†æ‰©å¤§åº”ç”¨èŒƒå›´</p>
</li>
<li>
<p><strong>å»ºç«‹å®Œå–„çš„ç›‘æ§ä¸å‘Šè­¦</strong>ï¼šç¡®ä¿èƒ½åŠæ—¶å‘ç°å¹¶è§£å†³é—®é¢˜</p>
</li>
<li>
<p><strong>ä¿æŒæŠ€æœ¯æ ˆç®€å•</strong>ï¼šè¿‡å¤šçš„æ•°æ®åº“ç±»å‹ä¼šå¢åŠ ç»´æŠ¤è´Ÿæ‹…ï¼Œå°½é‡æ§åˆ¶ç§ç±»</p>
</li>
<li>
<p><strong>å…³æ³¨ç¤¾åŒºæ´»è·ƒåº¦</strong>ï¼šé€‰æ‹©ç¤¾åŒºæ´»è·ƒçš„å¼€æºäº§å“æˆ–æœ‰å®åŠ›çš„å•†ä¸šä¾›åº”å•†</p>
</li>
</ol>
<p>å¯¹äºæƒ³è¦å¼€å§‹äº‘åŸç”Ÿæ•°æ®åº“ä¹‹æ—…çš„å›¢é˜Ÿï¼Œå»ºè®®æŒ‰ä»¥ä¸‹æ­¥éª¤è¡ŒåŠ¨ï¼š</p>
<ol>
<li>é¦–å…ˆæ˜ç¡®åº”ç”¨çš„æ•°æ®ç‰¹å¾å’Œè®¿é—®æ¨¡å¼</li>
<li>åœ¨å¼€å‘ç¯å¢ƒæ­å»ºæ¦‚å¿µéªŒè¯(POC)</li>
<li>ä½¿ç”¨çœŸå®æ•°æ®é›†è¿›è¡ŒåŸºå‡†æµ‹è¯•</li>
<li>åˆ¶å®šè¯¦ç»†çš„è¿ç§»ç­–ç•¥å’Œå›é€€è®¡åˆ’</li>
<li>å°æ‰¹é‡åˆ‡æ¢ï¼Œé€æ­¥æ‰©å¤§è§„æ¨¡</li>
</ol>
<p>äº‘åŸç”Ÿæ•°æ®åº“é¢†åŸŸå‘å±•è¿…é€Ÿï¼Œå…³æ³¨æ–°æŠ€æœ¯çš„åŒæ—¶ï¼Œä¹Ÿè¦ä¿æŒå¯¹åŸºæœ¬åŸåˆ™çš„åšæŒï¼šå¯é æ€§ã€æ•°æ®å®‰å…¨å’Œå¯ç®¡ç†æ€§å§‹ç»ˆæ˜¯è¯„ä¼°æ•°æ®åº“è§£å†³æ–¹æ¡ˆçš„æ ¸å¿ƒæ ‡å‡†ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ åœ¨äº‘åŸç”Ÿæ•°æ®åº“é€‰å‹å’Œå®è·µä¸­å°‘èµ°å¼¯è·¯ã€‚å¦‚æœæœ‰é—®é¢˜æˆ–ç»éªŒåˆ†äº«ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºè®¨è®ºï¼</p>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/">äº‘åŸç”Ÿ</a>
                    
                      <a class="hover-with-bg" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a>
                    
                      <a class="hover-with-bg" href="/tags/Kubernetes/">Kubernetes</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/">åˆ†å¸ƒå¼å­˜å‚¨</a>
                    
                  </div>
                
              </div>
              
              
            </div>

            
              <!-- Comments -->
              <div class="comments" id="comments">
                
                
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      function loadDisqus() {
        var disqus_config = function () {
          this.page.url = 'https://blog.bopop.sbs/2025/03/10/äº‘åŸç”Ÿæ•°æ®åº“é€‰å‹ä¸å®è·µæŒ‡å—/';
          this.page.identifier = '/2025/03/10/äº‘åŸç”Ÿæ•°æ®åº“é€‰å‹ä¸å®è·µæŒ‡å—/';
        };
        (function () {
          var d = document,
            s = d.createElement('script');
          s.src = '//' + '' + '.disqus.com/embed.js';
          s.setAttribute('data-timestamp', new Date());
          (d.head || d.body).appendChild(s);
        })();
      }
      createObserver(loadDisqus, 'disqus_thread');
    </script>
    <noscript>Please enable JavaScript to view the
      <a target="_blank" href="https://disqus.com/?ref_noscript" rel="nofollow noopener noopener">comments powered by Disqus.</a>
    </noscript>
  </div>


              </div>
            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  
    <div class="col-lg-7 mx-auto nopadding-md">
      <div class="container custom mx-auto">
        <img src="/img/Bopop-logo.png" srcset="/img/loading.gif" class="rounded mx-auto d-block mt-5" style="width:220px; height:150px;">
      </div>
    </div>
  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <!-- <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a> -->
        <span>Â© Bopop</span>
    </div>
    

    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>







  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: 'article.markdown-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>





  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>




















</body>
</html>
